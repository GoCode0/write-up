from Crypto.PublicKey import RSA

n = 0x125165155E03AF44B26423BED827A0651B9B7A7A7E79CAC5B8D07A5AC0C25BF5B4F258C227348916A4BEFEB306BE79D75A8E4FAC2F7D8591D7F7F1E5006EAFF2D32E93FCB1A50CB5BD449A84840C71F9F0BAD999AEEED500DC32B7092D0B021ADDE2859D53C604F4B1613880FB4ADA66C5A19DA058BC7A6646B935C4D28A321BAD0A39BB387465775DBC2AD7184CE221BD0EBC3DE0FC0E9574B952A0CD7C2718D0696BA2B2AC5122708CD9643C8A28B3916D47B28F46C6AED7E91DF1A78278039B9197223D1A8B0E88F2DDC55766A28EEAAA571E4DAA7F2132D4028015A372B78B04B775987B1F6A420F5AD96D30D76CC3D354199C968A85390C85D4E12C7AEB050B1B04F430B23725EC5C13D0340138F66C6ACFA459461B4EBFBE5AF2B2D6907B8FA782E1652514529FDF343667E6875D7D1498F3D80CB76524580B6F2AF01142F15BB10E91366DD882F7738FB2C242B417A4F2E0CFA5CD6FD6B63D1972901DF69B9D5C4817782494309E80954D1C90E975592A47CCE447619F5A3D5B7612BB667BBB14E1774964B14EA97CEA375F99F7A19DA543A9B4E9A978BDBFB2FFF8F35E8E9597473888CB12B2EFEF708D871489E7DDB3CA64997AC6F4AD29C7E13D3545EB056A2E872CE32F13DF5ECEDD25B7BDD7C32464306466D2E5B7E48AF9ACE8A81E429581AB377468C7F03103EF758EAEFB79A740489926FD8F26334FDA1D65
p = 3627991603884808062736141310447106260943326330899396275199779984022462194376994246446102117532813224234792046840726872009503786329408256663119027353255969224649727885389580250774873824390822482215139013309728202469835336298188620697403248917907049738004864552884412233025397042416703298163382725246031075810130222032765486555500736412969415261015967808462136504839813036078699995347830504646364842806157413675646357345753021818180743963892741139070590339137165833818468345693182851348835784086931651709553805159969447778964285167310407227065749316889692916103874856521269259363246539154909931419853080560118329293059
assert n % p == 0

q = n // p
e = 0x10001
phin = (p - 1) * (q - 1)
d = pow(e, -1, phin)
u = pow(p, -1, q)

key = RSA.construct((n, e, d, p, q, u))

with open("key.pem", "wb") as f:
    f.write(key.export_key("PEM"))


"""
ssh user@bro-key-n.chal.uiuc.tf -p 1337
Congratulations! You found my key - if you take a look at it carefully, you'll find the flag - replace slashes in the key with underscores to get your flag...:
uiuctf{hidden_in_plain_sight}
Connection to bro-key-n.chal.uiuc.tf closed.
"""
